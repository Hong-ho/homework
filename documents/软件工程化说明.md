# 智能菜谱生成系统 - 软件工程化说明文档

---

## 1. 文档目的

本说明旨在描述本系统在软件工程化实践中的规范和设计，包括目录结构、开发流程、自动化部署、测试策略、扩展性考虑等内容，确保团队协作高效、系统可维护、持续交付可靠。

---

## 2. 项目目录结构与模块划分

```
app/
├── classes/            # 类定义及数据结构
├── data/               # 用户数据与缓存
│   └── user_data/      # 以用户ID分类的历史数据
├── documents/          # UMLS相关文档与工具
├── static/             # 前端静态资源（JS/CSS）
├── templates/          # 前端HTML模板（Jinja2）
├── utils/              # 工具类函数（如图像处理、模型调用）
├── main.py             # 系统入口
├── requirements.txt    # 项目依赖列表
├── .vscode/            # 编辑器配置
└── tests/              # 单元测试与集成测试目录（推荐添加）
```

模块之间采用**低耦合高内聚**设计，各子系统间通过清晰接口通信，支持独立开发与测试。

---

## 3. 开发规范与代码风格

### 3.1 编码规范

- 使用 `PEP8` 风格进行 Python 编码
- 命名规范：
  - 变量/函数：`snake_case`
  - 类名：`PascalCase`
- 每个模块包含 docstring 文档注释
- Git 提交信息需语义清晰，建议使用：
  ```
  feat: 添加新的菜谱生成逻辑
  fix: 修复图像路径编码问题
  docs: 更新架构设计文档
  ```

### 3.2 版本控制

- 使用 Git 进行版本管理，仓库结构清晰
- 分支策略推荐：
  - `main`: 稳定版本
  - `dev`: 开发主干
  - `feature/xxx`: 新功能开发
  - `bugfix/xxx`: 修复分支

---

## 4. 自动化测试与质量保障

### 4.1 测试策略

- 单元测试（utils、AI接口、逻辑函数）
- 接口测试（API endpoints）
- 集成测试（完整流程验证）

推荐框架：`pytest` + `coverage`

### 4.2 测试示例

```python
def test_generate_recipe():
    from utils.recipe import generate_recipe
    result = generate_recipe("鸡蛋, 西红柿", "家常菜")
    assert "步骤" in result
```

### 4.3 代码质量控制

- 使用 `flake8` / `pylint` 检查代码风格
- 使用 `black` 格式化代码

---

## 5. 自动化构建与部署（CI/CD）

### 5.1 CI工作流（可使用GitHub Actions）

```yaml
name: Python Application CI

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
    - name: Install dependencies
      run: |
        pip install -r requirements.txt
    - name: Run tests
      run: |
        pytest --disable-warnings
```

### 5.2 部署建议

- 本地部署：Flask 运行或使用 gunicorn
- 云部署：可选腾讯云、阿里云、Render、Vercel等
- 容器化：建议使用 Docker 打包部署
- 数据备份：每周自动快照 user_data 和数据库文件夹

---

## 6. 配置管理

- 使用 `.env` 或 `config.py` 管理环境变量，如：
  ```
  OPENAI_API_KEY=your_key_here
  IMAGE_MODEL=stable-diffusion
  DEBUG=True
  ```

- 配置文件应与代码解耦，支持切换 dev/prod 环境

---

## 7. 可扩展性设计

### 7.1 模块扩展

- 新风格 / 语言支持 → 扩展语言模型调用逻辑
- 多图像引擎支持 → 抽象接口 `ImageGenerator` 以适配 SD、DALL·E 等
- 营养分析 → 模块化设计，允许后期接入 OpenFoodFacts、食物数据库API

### 7.2 插件化结构（预留）

- 使用钩子（hook）系统，在生成后插入图像/营养模块处理
- 配置式任务流（JSON定义生成流程）

---

## 8. 项目协作与文档

- 关键文档：
  - 需求分析报告.md
  - 架构设计文档.md
  - 系统建模报告.md
  - 团队工作分配报告.md
  - 软件配置与运维文档.md
  - 本文档：软件工程化说明.md
- 所有文档放置于 `documents/` 或根目录中，版本控制同步更新
- 建议使用 Typora 或 VS Code Markdown 插件统一查看格式

---

## 9. 总结与建议

本系统已初步具备良好的工程化基础，后续开发过程中建议：

- 持续集成代码质量与测试覆盖
- 统一日志管理与异常追踪（可集成 Sentry）
- 保持模块解耦，利于多人并行开发
- 以用户体验为中心设计前后端联动细节

---

持续优化工程实践是提升项目生命力的关键，欢迎团队成员就此文档提出补充或建议。
